(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,a=window.wp.element,l={layout:"vertical",format:"default",size:"medium",titleBgGray:!1,hasImage:!0,inverted:!1,boxed:!1,sponsored:!1},n={layout:[{label:"Vertical",value:"vertical"},{label:"Horizontal",value:"horizontal"},{label:"Destaque",value:"highlight"}],format:[{label:"Padrão",value:"default"},{label:"Story",value:"story"},{label:"Vídeo",value:"video"},{label:"Galeria",value:"gallery"}],size:[{label:"XG",value:"giga"},{label:"GG",value:"mega"},{label:"G",value:"large"},{label:"M",value:"medium"},{label:"P",value:"small"}],sponsorTypes:[{label:"Publicitário",value:"Especial Publicitário"},{label:"Patrocinado",value:"Especial Patrocinado"}]};function o(e){const t=[];return e?.layout&&t.push(`news--${e.layout}`),e?.format&&t.push(`news--${e.format}`),e?.size&&t.push(`news--${e.size}`),e?.hasImage&&e.image&&t.push("news--has-image"),e?.hasImage&&e.image||t.push("news--no-image"),e?.titleBgGray&&t.push("news--title-gray"),e?.inverted&&t.push("news--inverted"),e?.boxed&&t.push("news--boxed"),e?.sponsored&&t.push("news--sponsored"),t.join(" ")}const r=window.wp.blockEditor;function i({attributes:e}){const t=o(e),l=(0,r.useBlockProps)({className:t}),n=(0,r.useInnerBlocksProps)(l,e);return(0,a.createElement)("article",{...n},(0,a.createElement)("div",{class:"news__wrapper"},e.hasImage&&e.image&&(0,a.createElement)(a.Fragment,null,"highlight"===e.layout&&(0,a.createElement)("div",{class:"news__image",style:{backgroundImage:`url(${e.image})`,backgroundPositionX:100*e.imagePosX+"%",backgroundPositionY:100*e.imagePosY+"%"}}),"highlight"!==e.layout&&(0,a.createElement)("div",{class:"news__image"},(0,a.createElement)("img",{src:e.image,alt:e.title,style:{objectPosition:`${100*e.imagePosX}% ${100*e.imagePosY}%`}}))),(0,a.createElement)("div",{class:"news__content"},(0,a.createElement)("div",{class:"news__hat"},(0,a.createElement)("span",null,e.hat)),(0,a.createElement)("h2",{class:"news__title"},(0,a.createElement)("span",null,e.title)),e.sponsored&&e?.sponsorName&&(0,a.createElement)("div",{class:"news__sponsor"},"por ",e.sponsorName))),e?.relateds&&(0,a.createElement)("ul",{class:"news__relateds"},e.relateds.map((e=>(0,a.createElement)("li",null,(0,a.createElement)("span",null,e.title))))))}function s({attributes:e,debugState:[t,l]}){const n=o(e);return(0,a.createElement)(a.Fragment,null,t.block&&(0,a.createElement)("div",null,(0,a.createElement)("code",{style:{display:"block"},dangerouslySetInnerHTML:{__html:JSON.stringify(e,null,2)}})),t.classes&&(0,a.createElement)("div",null,(0,a.createElement)("code",{style:{display:"block"},dangerouslySetInnerHTML:{__html:JSON.stringify(n,null,2)}})))}const c=window.wp.components;function m({initialOpen:e,debugState:t}){const[l,n]=t;return(0,a.createElement)(c.PanelBody,{title:"Desenvolvimento",initialOpen:e},(0,a.createElement)(c.ToggleControl,{label:"Debug - Bloco",help:"Mostra a saída JSON do bloco",checked:l.block,onChange:()=>n({...l,block:!l.block})}),(0,a.createElement)(c.ToggleControl,{label:"Debug - Classes",help:"Mostra a saída JSON das Classes CSS",checked:l.classes,onChange:()=>n({...l,classes:!l.classes})}))}function u({initialOpen:e,attributes:t,setAttributes:l,openModal:n,isOpenModal:o}){return(0,a.createElement)(c.PanelBody,{title:"Conteúdo",icon:"database-view",initialOpen:e},(0,a.createElement)(c.BaseControl,{label:"Matéria",help:"Pesquise e selecione uma matéria diretamente do banco de dados do site."},(0,a.createElement)("div",null,(0,a.createElement)(c.Button,{variant:"primary",onClick:n,disabled:o,icon:(0,a.createElement)(c.Icon,{icon:"search"})},"Pesquisar Matéria"))),(0,a.createElement)(c.ToggleControl,{label:"Sobrescrever?",help:"Sobrescreve dados do post no card",checked:t.overwrite,onChange:()=>l({overwrite:!t.overwrite})}),t.overwrite&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(c.TextControl,{label:"Chapéu",value:t.hat,onChange:e=>l({hat:e})}),(0,a.createElement)(c.TextControl,{label:"Título",value:t.title,onChange:e=>l({title:e})}),(0,a.createElement)(c.TextControl,{label:"Link",value:t.link,onChange:e=>l({link:e})}),(0,a.createElement)(c.BaseControl,{label:"Imagem"},t.image&&(0,a.createElement)("figure",null,(0,a.createElement)("img",{src:t.image,style:{width:"100%",aspectRatio:"16/9",objectFit:"cover",objectPosition:`${100*t.imagePosX}% ${100*t.imagePosY}%`}})),(0,a.createElement)(c.Flex,{direction:"row",gap:1},(0,a.createElement)(r.MediaUploadCheck,null,(0,a.createElement)(r.MediaUpload,{title:t.image?"Alterar imagem":"Selecionar imagem",value:void 0,onSelect:e=>{console.log("Media selecionada",e),l({image:e.sizes?.large?.url||e.sizes.full.url})},allowedTypes:["image"],render:({open:e})=>(0,a.createElement)(c.Button,{variant:"secondary",style:{flex:1,justifyContent:"center"},onClick:e},t.image?"Alterar":"Selecionar Imagem")})),t.image&&(0,a.createElement)(c.Button,{variant:"secondary",style:{flex:1,justifyContent:"center"},onClick:()=>l({image:"",imagePosX:void 0,imagePosY:void 0})},"Remover")))))}function d({attributes:e,setAttributes:t,setOpenFocal:l}){const[n,o]=(0,a.useState)({x:e.imagePosX||.5,y:e.imagePosY||.5});return(0,a.createElement)(c.BaseControl,{label:"Posicionamento da Image",help:"Ajuste o posicionamento da imagem para otimizar o foco na área de interesse desejada.",className:"nmb",__nextHasNoMarginBottom:!0},(0,a.createElement)(c.FocalPointPicker,{url:e.image,dimensions:{width:248,height:148},value:n,onChange:e=>{o(e),t({imagePosX:e.x,imagePosY:e.y})}}),(0,a.createElement)(c.Button,{variant:"secondary",onClick:()=>{t({imagePosX:n.x,imagePosY:n.y}),l(!1)},style:{width:"100%",justifyContent:"center"}},"Confirmar Posicionamento"))}function g({initialOpen:e,attributes:t,setAttributes:l}){const[o,r]=(0,a.useState)(!1);return(0,a.createElement)(c.PanelBody,{title:"Aparência",icon:"admin-appearance",initialOpen:e},!!t.image&&!!o&&(0,a.createElement)(d,{attributes:t,setAttributes:l,setOpenFocal:r}),!o&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(c.SelectControl,{label:"Layout do card",options:n.layout,value:t.layout,onChange:e=>l({layout:e})}),(0,a.createElement)(c.BaseControl,{label:"Tamanho do card"},(0,a.createElement)(c.Flex,{direction:"row",gap:1},(0,a.createElement)(c.ButtonGroup,{style:{width:"100%"}},n.size.map((e=>(0,a.createElement)(c.Button,{variant:t.size===e.value?"primary":"secondary",onClick:()=>l({size:e.value})},e.label)))))),(0,a.createElement)(c.BaseControl,{label:"Imagem"},(0,a.createElement)(c.Button,{variant:"secondary",disabled:o,onClick:()=>r(!o),style:{width:"100%",marginBottom:"1rem",justifyContent:"center"}},"Alterar Posicionamento"),(0,a.createElement)(c.ToggleControl,{label:"Exibir imagem",help:"Mostra ou oculta a imagem",checked:t.hasImage,onChange:()=>l({hasImage:!t.hasImage})}),(0,a.createElement)(c.ToggleControl,{label:"Inverter ordem",help:"Inverte a ordem da imagem e título",checked:t.inverted,onChange:()=>l({inverted:!t.inverted})})),(0,a.createElement)(c.SelectControl,{label:"Formato do conteúdo",options:n.format,value:t.format,onChange:e=>l({format:e})}),(0,a.createElement)(c.ToggleControl,{label:"Título em cinza",help:"Adiciona um fundo cinza no título do card",checked:t.titleBgGray,onChange:()=>l({titleBgGray:!t.titleBgGray})}),(0,a.createElement)(c.ToggleControl,{label:"Caixa branca",help:"Adiciona um gap e uma caixa branca ao redor do card",checked:t.boxed,onChange:()=>l({boxed:!t.boxed})}),(0,a.createElement)(c.ToggleControl,{label:"Patrocinado",help:"Marque se este for um conteúdo pago",checked:t.sponsored,onChange:e=>{const a={sponsored:!t.sponsored,sponsor:e?t.sponsor?t.sponsor:n.sponsorTypes[0].value:""};l(a)}}),t.sponsored&&(0,a.createElement)(c.BaseControl,{label:"Especial",help:"O Chapéu do card será sobrescrito por este termo"},(0,a.createElement)(c.Flex,{direction:"row",gap:1},(0,a.createElement)(c.ButtonGroup,{style:{width:"100%"}},n.sponsorTypes.map((e=>(0,a.createElement)(c.Button,{variant:t.sponsor===e.value?"primary":"secondary",onClick:()=>l({sponsor:e.value,hat:e.value})},e.label))))))))}function p({attributes:e,setAttributes:t,openModal:l,isOpenModal:n,debugState:o}){return(0,a.createElement)(r.InspectorControls,null,(0,a.createElement)(u,{initialOpen:!1,attributes:e,setAttributes:t,openModal:l,isOpenModal:n}),(0,a.createElement)(g,{initialOpen:!1,attributes:e,setAttributes:t}),(0,a.createElement)(m,{initialOpen:!1,debugState:o}))}const h=window.wp.apiFetch;var b=e.n(h);function E({id:e,hat:t,site:l,title:n,link:o,image:r,type:i,onSelectPost:s}){return(0,a.createElement)(c.FlexItem,{isBlock:!0,style:{flex:"1 1 auto",border:"1px solid #ddd",padding:"1rem"}},(0,a.createElement)(c.Flex,{direction:"row",align:"flex-start",expanded:!0,gap:4,wrap:!1},r&&(0,a.createElement)(c.FlexItem,{style:{maxWidth:"100px"}},(0,a.createElement)("img",{src:r,style:{width:"100px",aspectRatio:"4/3",objectFit:"cover",objectPosition:"center",backgroundColor:"#ddd"}})),(0,a.createElement)(c.FlexItem,{isBlock:!0},(0,a.createElement)("h4",{title:n,style:{fontSize:"1.25rem",lineHeight:1.4,margin:0}},n),(0,a.createElement)("div",null,o),(0,a.createElement)("div",null,"Site: ",l," | Chapéu: ",t),(0,a.createElement)("div",null,"Tipo: ",i," | ID: ",e)),(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(c.Flex,{direction:"column",expanded:!0,gap:2,wrap:!0},(0,a.createElement)(c.Button,{variant:"secondary",icon:(0,a.createElement)(c.Icon,{icon:"yes"}),onClick:()=>s({id:e,hat:t,title:n,link:o,image:r})},"Selecionar"),(0,a.createElement)(c.Button,{href:o,target:"_blank",isSmall:!0,variant:"tertiary",icon:(0,a.createElement)(c.Icon,{icon:"visibility"}),iconSize:16},"Visualizar")))))}function v({setAttributes:e,close:t}){const[l,n]=(0,a.useState)(""),[o,r]=(0,a.useState)(!1),[i,s]=(0,a.useState)([]);function m(a){e({...a}),t(),n("")}async function u(){if(0!==l.length&&l.length<3)return;r(!0);const e=await async function(e,t,a){const l={from:(a=a||20)*(t=t||1)-a,size:a,_source:["site","externalId","title","type","status","slug","hat","uri","thumbnail","createdAt","updatedAt","uuid"],sort:[{createdAt:{order:"desc"}}]},n=[];return e&&(n.unshift({fuzzy:{title:{value:e||"",fuzziness:"AUTO"}}}),l.query={bool:{must:n}}),await b()({path:"/morpheus/v1/elasticsearch",method:"POST",data:l})}(l);s(e),r(!1)}async function d(e){e.preventDefault(),await u()}return(0,a.useEffect)((()=>{u()}),[]),(0,a.createElement)(c.Modal,{title:"Pesquisar Matéria",onRequestClose:t,shouldCloseOnClickOutside:!1,isFullScreen:!0,className:"morpheus-news-modal"},(0,a.createElement)("form",{onSubmit:d,style:{display:"flex",gap:"1rem"}},(0,a.createElement)("div",{style:{flex:1}},(0,a.createElement)(c.SearchControl,{label:"Pesquisar Matéria",help:"Digite o título da matéria que deseja encontrar",value:l,disabled:o,onChange:e=>n(e),onClose:async function(e){e.preventDefault(),n("")}})),(0,a.createElement)(c.Button,{type:"submit",variant:"primary",disabled:o,onClick:d,style:{height:"48px"}},"Buscar")),(0,a.createElement)(c.Flex,{direction:"column",expanded:!0,gap:2,wrap:!0,className:"search-results"},o&&(0,a.createElement)("div",{className:"search-placeholder"},(0,a.createElement)("div",{className:"search-placeholder-loading"},(0,a.createElement)(c.Spinner,{style:{width:30,height:30}}),(0,a.createElement)("div",null,"Pesquisando, aguarde..."))),!o&&!i.length&&(0,a.createElement)("div",{className:"search-placeholder"},(0,a.createElement)("div",{className:"search-placeholder-loading"},(0,a.createElement)("div",null,"Nenhum resultado encontrado."))),!o&&!!i.length&&i.map((e=>(0,a.createElement)(E,{...e,onSelectPost:m})))))}const y=JSON.parse('{"u2":"morpheus/news"}');(0,t.registerBlockType)(y.u2,{edit:function({attributes:e,setAttributes:t}){const[n,o]=(0,a.useState)(!1),r=(0,a.useState)({block:!1,classes:!1});return(0,a.useEffect)((()=>{!function(e,t){const a=Object.entries(l),n={};for(const[t,l]of a)void 0===e[t]&&(n[t]=l);t({...n})}(e,t)}),[]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(p,{attributes:e,setAttributes:t,openModal:()=>o(!0),isOpenModal:n,debugState:r}),n&&(0,a.createElement)(v,{attributes:e,setAttributes:t,close:()=>o(!1),isOpen:n}),(0,a.createElement)(i,{attributes:e}),(0,a.createElement)(s,{debugState:r,attributes:e}))}})})();